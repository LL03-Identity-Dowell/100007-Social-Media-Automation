{% extends "article/base_steps.html" %}
{% load static %}
{% block content %}
<!DOCTYPE html>
<html>
    <head>
     <meta name="viewport" content="width=device-width, initial-scale=1.0">
<link href="https://fonts.googleapis.com/css?family=Raleway" rel="stylesheet">
{% comment %} <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.1/dist/css/bootstrap.min.css" rel="stylesheet"
      integrity="sha384-F3w7mX95PdgyTmZZMECAngseQB83DfGTowi0iMjiWaeVhAn4FJkqJByhZMI3AhiU" crossorigin="anonymous"> {% endcomment %}
    </head>


<style>
    * {
        box-sizing: border-box;
    }

    /*body {*/
    /*    background-color: #f1f1f1;*/
    /*}*/

    input.invalid {
        background-color: #ffdddd;
    }

    #regForm {
        background-color: #ffffff;
        margin: 100px auto;
        font-family: Raleway;
        padding: 40px;
        width: 70%;
        min-width: 300px;
        border-radius: 0.3em;
    }

    h1 {
        text-align: center;
    }


    /* Hide all steps by default: */
    .tab {
        display: none;
    }

    button#nextBtn {
        border-color: #ffc107;
        background-color: #ffc107;
        color: #212529;
    }

    button {

        border: none;
        padding: 10px 20px;
        font-size: 17px;
        font-family: Raleway;
        cursor: pointer;
    }

    button:hover {
        opacity: 0.8;
    }

    /* Make circles that indicate the steps of the form: */
    /*.step {*/
    /*    height: 15px;*/
    /*    width: 15px;*/
    /*    margin: 0 2px;*/
    /*    background-color: #47ce29;*/
    /*    border: none;*/
    /*    border-radius: 50%;*/
    /*    display: inline-block;*/
    /*    opacity: 0.5;*/
    /*}*/

    /*.step.active {*/
    /*    opacity: 1;*/
    /*}*/

    /* Mark the steps that are finished and valid: */
    /*.step.finish {*/
    /*    background-color: #04AA6D;*/
    /*}*/

    #submitBtn {
        display: none;
    }

    .custom-radio-list {
        list-style-type: none;
        padding: 0;
        margin: 4px;
    }

   .required_field {
        font-size: 1em;
        color: red;
    }

    .popup {
    position: fixed;
    top: 20px; /* Adjust the top position as per your needs */
    right: 20px; /* Adjust the right position as per your needs */
    padding: 20px;
    background-color: rgba(255, 255, 255, 0.8); /* Adjust the alpha value (0.8 in this example) */
    border: none;
    box-shadow: none;
    font-style: italic;
    z-index: 9999;
    animation: slideIn 0.5s ease-in-out;
}

.cancel-icon {
  position: absolute;
  top: 5px;
  right: 5px;
  cursor: pointer;
  font-size: 16px;
}

.popup p {
  margin: 0;
  padding: 0;
}

.popup::after {
    content: "";
    position: absolute;
    bottom: 0;
    left: 0;
    width: 100%; /* Set initial width to full */
  transition: width 30s linear;
    height: 4px;
    background-color: green;
}

.popup.timeout::after {
  animation: decreaseWidth 10s linear forwards; /* Use animation for decreasing width */
}

@keyframes decreaseWidth {
  0% {
    width: 100%; /* Set initial width to full */
  }
  100% {
    width: 0; /* Decrease width to 0 */
  }
}

@keyframes slideIn {
    0% { transform: translateX(100%); }
    100% { transform: translateX(0); }
}



</style>
<body>

<form id="regForm" action="{% url 'index' %}" method="post">

    <!-- One "tab" for each step in the form: -->
    <!--{% csrf_token %}-->
    <!--<div class="tab">-->
    <!--    <h1><b>Email ID input:</b></h1>-->

    <!--    {% for input in emailForm %}-->

    <!--        <span class="row"><span>{{ input.label }}:{% if input.field.required %}-->
    <!--            <span class="required_field">*</span>{% endif %} </span>{{ input }}</span>-->
    <!--    {% endfor %}-->
    <!--</div>-->
    <!-- <div id="popupMessage" class="popup"></div> -->
    {#    <div class="tab">#}
    {##}
    {##}
    {#        <h1><b>Hashtags:</b></h1>#}
    {##}
    {#        <p class="hashtag">Use at least one hashtag from each group</p>#}
    {#todo continue from here to add hashtags#}
    {#        <p class="hashtag">Group 1 - industry based hashtags</p>#}
    {#        <p class="hashtag">#livinglab</p>#}
    {#        <p class="hashtag">#innovation</p>#}
    {#        <p class="hashtag">#userexperience</p>#}
    {#        <p class="hashtag">#storytelling</p>#}
    {#        <p class="hashtag">#consumerbehavior</p>#}
    {#        <p class="hashtag">#behavioraleconomics</p>#}
    {#        <p class="hashtag">#ux</p>#}
    {#        <p class="hashtag">#consumerinsights</p>#}
    {#        <p class="hashtag">#statistics</p>#}
    {#        <p class="hashtag separator">--------------------------------------------------</p>#}
    {#        <p class="hashtag">Group 2 - DoWell hashtags</p>#}
    {#        <p class="hashtag">#truemoments - awareness brand</p>#}
    {#        <p class="hashtag">#seeuser - awareness brand</p>#}
    {#        <p class="hashtag">#stattricks - knowledge brand</p>#}
    {#        <p class="hashtag">#dowellcomprehend - knowledge brand</p>#}
    {#        <p class="hashtag">#uxlivinglab - Product brand</p>#}
    {#        <p class="hashtag">#unpackandwin - Product brand</p>#}
    {#        <p class="hashtag">#dowellresearch - Corporate brand</p>#}
    {#        <p class="hashtag">#openinnovationacademy - non profit brand</p>#}
    {#        <p class="hashtag separator">------------------------------------------------------------</p>#}
    {#        <p class="hashtag">Group 3 - Most used hashtags</p>#}
    {#        <p class="hashtag">#goodmorning</p>#}
    {#        <p class="hashtag">#thankyou</p>#}
    {#        <p class="hashtag">#internship</p>#}
    {#        <p class="hashtag">#genz</p>#}
    {#        <p class="hashtag">#sales</p>#}
    {#        <p class="hashtag">#strategy</p>#}
    {#        <p class="hashtag">#business</p>#}
    {#        <p class="hashtag">#digitaltwin</p>#}
    {#        <p class="hashtag">#germany</p>#}
    {#        <p class="hashtag">#singapore</p>#}
    {#        <p class="hashtag">#london</p>#}
    {#        <p class="hashtag">#usa</p>#}
    {#        <p class="hashtag">#sweden</p>#}
    {#        <p class="hashtag separator">-----------------------------------------------------------</p>#}
    {#        <p class="hashtag">Group 4 - client hashtags</p>#}
    {#        <p class="hashtag">#google</p>#}
    {#        <p class="hashtag">#amazon</p>#}
    {#        <p class="hashtag">#microsoft</p>#}
    {#        <p class="hashtag">#apple</p>#}
    {#        <p class="hashtag">#facebook</p>#}
    {#        <p class="hashtag separator">-----------------------------------------------------------</p>#}
    {#        <p class="hashtag">Group 5 - event hashtags</p>#}
    {##}
    {##}
    {#        <p class="hashtag separator">--------------------------------------------------------</p>#}
    {#        <p class="hashtag">Work flow</p>#}
    {#        <p class="hashtag">Step 1- Select a topic</p>#}
    {#        <p class="hashtag">Step 2 -Create post using AI</p>#}
    {#        <p class="hashtag">Step 3 - Edit, Copy each post and paste in this form</p>#}
    {#        <p class="hashtag">Step 4 - Add relevant hashtags and mentions</p>#}
    {#        <p class="hashtag">Step 5 - Select a copyright free photo or create it connecting to the post</p>#}
    {#        <p class="hashtag">Step 6 - Upload as image /video and submit</p>#}
    {#        <p class="hashtag">Step 7 - Select relevant social media channel to post</p>#}
    {#    </div>#}

<div class="tab">
    <h1><b>Industry Information:</b></h1>
    {% for input in industryForm %}
        <p>
            <span>{{ input.label }}:
                {% if input.field.required %}
                    <span class="required_field">*</span>&nbsp;&nbsp;
                {% endif %}
            </span>
            {{ input }}
            {{input.errors}}
        </p>
    {% endfor %}

    <span class="input-group mb-3">
        <span>{{ sentencesForm.subject_determinant.label }}:</span>&nbsp;
        {{ sentencesForm.subject_determinant }}
        &nbsp;&nbsp;
           <span class="help_text">{{ sentencesForm.subject_determinant.help_text }}</span>
        <span>{{ sentencesForm.subject.label }}:
            {% if sentencesForm.subject.field.required %}
                <span class="required_field">*</span>&nbsp;&nbsp;
            {% endif %}
            <span class="help_text">{{ sentencesForm.subject.help_text }}</span>
        </span>
        &nbsp;{{ sentencesForm.subject }}
        &nbsp;{{ sentencesForm.subject_number }}
        {{ sentencesForm.subject.errors }}
    </span>

    <span class="input-group mb-3">
        <span>{{ sentencesForm.object_determinant.label }}:</span>&nbsp;
        {{ sentencesForm.object_determinant }}
        &nbsp;&nbsp;
        <span>{{ sentencesForm.object.label }}:
            {% if sentencesForm.object_determinant.field.required %}
                <span class="required_field">*</span>&nbsp;&nbsp;
            {% endif %}
            <span class="help_text">{{ sentencesForm.object.help_text }}</span>
            <span class="help_text">{{ sentencesForm.object_determinant.help_text }}</span>
        </span>
        &nbsp;{{ sentencesForm.object }}
        &nbsp;{{ sentencesForm.object_number }}
        {{ sentencesForm.object.errors }}
    </span>

    <span class="row">
        <span>{{ sentencesForm.verb.label }}:
            {% if sentencesForm.verb.field.required %}
                <span class="required_field">*</span>&nbsp;&nbsp;
            {% endif %}
            <span class="help_text">{{ sentencesForm.verb.help_text }}</span>
        </span>
        {{ sentencesForm.verb }}
        {{ sentencesForm.verb.errors }}
    </span>

    <span class="row">
        <span>{{ sentencesForm.adjective.label }}:
            {% if sentencesForm.adjective.field.required %}
                <span class="required_field">*</span>&nbsp;&nbsp;
            {% endif %}
            <span class="help_text">{{ sentencesForm.adjective.help_text }}</span>
        </span>
        {{ sentencesForm.adjective }}
        {{ sentencesForm.adjective.errors }}
    </span>

</div>
<br>
         <p style="margin-top: 29px; font-size: 1.1rem; font-style: italic;"><span style="font-weight: 600">Your sample output (present/past perfect) :</span> <span id="sentencePreview" style="color: #250ddb;"> The Livinglab was testing workflow ai digital documentation.<span> </p>
         <p style="font-size: smaller;">Click 'Submit' to view more topic instances<p>

    {#todo remove final part in order to generate different messages#}
    {#    <div class="tab"><h1><b>Sentence Grammar</b></h1>#}
    {#        <span class=" row input-group mb-3"><span>{{ sentencesForm.tense.label }}: {% if sentencesForm.tense.field.required %} <span class=" required_field">*</span>{% endif %}</span>{{ sentencesForm.tense }}&nbsp;&nbsp</span>&nbsp;&nbsp;#}
    {#        <span class="input-group mb-3"><span>{{ sentencesForm.sentence_art.label }}: {% if sentencesForm.sentence_art.field.required %} <span class=" required_field">*</span>{% endif %}</span>&nbsp;{{ sentencesForm.sentence_art }}&nbsp;&nbsp;#}
    {#                <span>{{ sentencesForm.modal_verb.label }}: {% if sentencesForm.modal_verb.field.required %} <span class=" required_field">*</span>{% endif %}</span>&nbsp;{{ sentencesForm.modal_verb }}</span>#}
    {#        <span class="row"><span>{{ sentencesForm.progressive.label }}: {% if sentencesForm.progressive.field.required %} <span class=" required_field">*</span>{% endif %}</span>{{ sentencesForm.progressive }}</span>#}
    {#        <span class="row"><span>{{ sentencesForm.perfect.label }}:{% if sentencesForm.perfect.field.required %} <span class=" required_field">*</span>{% endif %} </span>{{ sentencesForm.perfect }}</span>#}
    {#        <span class="row"><span>{{ sentencesForm.negated.label }}: {% if sentencesForm.negated.field.required %} <span class=" required_field">*</span>{% endif %}</span>{{ sentencesForm.negated }}</span>#}
    {#        <span class="row"><span>{{ sentencesForm.passive.label }}:{% if sentencesForm.passive.field.required %} <span class=" required_field">*</span>{% endif %} </span>{{ sentencesForm.passive }}</span>#}
    {#    </div>#}

    <div style="overflow:auto;" class="mt-5">
        {% if profile == 'Admin' or 'Add/Edit' %}
        <div style="float:right;">
            <button type="button" id="prevBtn" class="btn btn-danger" onclick="nextPrev(-1)">Previous</button>
            <button type="button" id="nextBtn" class="btn btn-warning" onclick="nextPrev(1)">Next</button>
            <button type="submit" id="submitBtn" class="btn btn-success">Submit</button>

        </div>
        {% else %}
        <div style="float:right;">
            <button type="button" id="prevBtn" class="btn btn-danger" onclick="nextPrev(-1)">Previous</button>
            <button type="button" id="nextBtn" class="btn btn-warning" onclick="notAdmin()">Next</button>
            <button type="subm" id="submitBtn" class="btn btn-success">Submit</button>

        </div>
        {% endif %}
    </div>
    <!-- Circles which indicates the steps of the form: -->
    <div style="text-align:center;margin-top:40px;">

        <span class="step"></span>
        <span class="step"></span>
    </div>
</form>

<script>

  {% comment %} console.log({{ sentencesForm.adjective}})  {% endcomment %}
  {% comment %} <select name="subject_determinant" class="form-select" id="id_subject_determinant">
  <option value="-"></option>

  <option value="the" selected>the</option>

  <option value="a">a</option>

  <option value="an">an</option>

</select> {% endcomment %}

{% comment %} ======================== {% endcomment %}

{% comment %} <select name="subject" class="form-select" id="id_subject">
  <option value="Livinglab">Livinglab</option>

  <option value="Innovation">Innovation</option>

  <option value="User experience">User experience</option>

  <option value="Storytelling">Storytelling</option>

  <option value="Consumer Behaviour">Consumer Behaviour</option>

  <option value="Behavioral economics">Behavioral economics</option>

  <option value="Consumer Insights">Consumer Insights</option>

  <option value="Statistics" selected>Statistics</option>

</select> {% endcomment %}

//========================
//<select name="object_determinant" class="form-select" id="id_object_determinant">
// <option value="-"></option>

//  <option value="the">the</option>

//  <option value="a">a</option>

//  <option value="an" selected>an</option>

//</select 

//======================== 
//<input type="text" name="verb" value="skills learning" class="form-control" maxlength="100" required id="id_verb"> {% 

// ========================

//<input type="text" name="adjective" value="training" class="form-control" maxlength="100" required id="id_adjective">

//======================== 
// <input type="text" name="object" value="to educate" class="form-control" maxlength="100" required id="id_object"> 

let specifyTopic;
let yourTopic;
//has/had
let activites; 
let specifyActivity;
let purposeOfArticle;

const idValues = ["id_subject_determinant", "id_subject", "id_verb", "id_adjective", "id_object"]
const display = document.getElementById("sentencePreview");

function capitalizeFirstLetter(word) {
  if (word.length === 0) {
    return word; // Return the word as-is if it's empty
  }

  const firstLetter = word.charAt(0).toUpperCase();
  const restOfWord = word.slice(1);
  
  return firstLetter + restOfWord;
}

function updateDisplay(){
  specifyTopic = document.getElementById("id_subject_determinant").value;
  let capitalizedSpecifyTopic = capitalizeFirstLetter(specifyTopic);
  yourTopic = document.getElementById("id_subject").value;
  //has/had
  activites = document.getElementById("id_verb").value;
  specifyActivity = document.getElementById("id_adjective").value;
  purposeOfArticle = document.getElementById("id_object").value;
  let sentencePreview = `${capitalizedSpecifyTopic} ${yourTopic} has/had ${activites} the/an ${specifyActivity} ${purposeOfArticle}`;
  display.innerHTML = sentencePreview;
}

idValues.forEach(id => {
  const element = document.getElementById(id);
  if(element){
    element.addEventListener("change", updateDisplay);
  }
})

updateDisplay();


function notAdmin() {

    $( "div.warning" ).fadeIn( 300 ).delay( 1500 ).fadeOut( 500 );
}



    var currentTab = 0; // Current tab is set to be the first tab (0)
    showTab(currentTab); // Display the current tab

    function showTab(n) {
        // This function will display the specified tab of the form...
        var x = document.getElementsByClassName("tab");
        x[n].style.display = "block";
        //... and fix the Previous/Next buttons:
        if (n == 0) {
            document.getElementById("prevBtn").style.display = "none";
        } else {
            document.getElementById("prevBtn").style.display = "inline";
        }
        if (n == (x.length - 1)) {
            document.getElementById("nextBtn").innerHTML = "Submit";
        } else {
            document.getElementById("nextBtn").innerHTML = "Next";
        }
        //... and run a function that will display the correct step indicator:
        fixStepIndicator(n)
    }

    function nextPrev(n) {
  // This function will figure out which tab to display
  var x = document.getElementsByClassName("tab");
  // Exit the function if any field in the current tab is invalid:
  if (n == 1 && !validateForm()) return false;
  // Hide the current tab:
  x[currentTab].style.display = "none";
  // Increase or decrease the current tab by 1:
  currentTab = currentTab + n;
  // if you have reached the end of the form...
  if (currentTab >= x.length) {
    // ... the form gets submitted:
    document.getElementById("regForm").submit();
    showPopup("Generating topics...");
    AmagiLoader.show();
    const popup = document.querySelector(".popup");
    popup.classList.add("timeout");
    setTimeout(() => {
      popup.remove();
    }, 10000);
    setTimeout(() => {
      AmagiLoader.hide();
    },30000);
    return false;
  }
  // Otherwise, display the correct tab:
  showTab(currentTab);
}


function showPopup(message) {
  const popup = document.createElement("div");
  popup.className = "popup";
  popup.innerHTML = `
    <span class="cancel-icon">&times;</span>
    <p>${message}</p>
  `;

  const cancelIcon = popup.querySelector(".cancel-icon");
  cancelIcon.addEventListener("click", () => {
    popup.remove();
  });

  document.body.appendChild(popup);
}


    function validateForm() {
        // This function deals with validation of the form fields
        var x, y, i, valid = true;
        x = document.getElementsByClassName("tab");
        y = x[currentTab].getElementsByTagName("input");
        // A loop that checks every input field in the current tab:
        for (i = 0; i < y.length; i++) {
            // If a field is empty...
            if (y[i].value == "") {
                // add an "invalid" class to the field:
                y[i].className += " invalid";
                // and set the current valid status to false
                valid = false;
            }
        }
        // If the valid status is true, mark the step as finished and valid:
        if (valid) {
            document.getElementsByClassName("step")[currentTab].className += " finish";
        }
        return valid; // return the valid status
    }

    function fixStepIndicator(n) {
        // This function removes the "active" class of all steps...
        var i, x = document.getElementsByClassName("step");
        for (i = 0; i < x.length; i++) {
            x[i].className = x[i].className.replace(" active", "");
        }
        //... and adds the "active" class on the current step:
        x[n].className += " active";
    }
    const AmagiLoader = {
      __loader: null,
      __progressText: null,
      show: function () {
        if (this.__loader == null) {
          var divContainer = document.createElement('div');
          divContainer.style.position = 'fixed';
          divContainer.style.left = '0';
          divContainer.style.top = '0';
          divContainer.style.width = '100%';
          divContainer.style.height = '100%';
          divContainer.style.zIndex = '9998';
          divContainer.style.backgroundColor = 'rgba(250, 250, 250, 0.80)';

          var div = document.createElement('div');
          div.style.position = 'absolute';
          div.style.left = '50%';
          div.style.top = '50%';
          div.style.zIndex = '9999';
          div.style.height = '100px';
            div.style.width = '100px';
          div.style.margin = '-76px 0 0 -76px';
          div.style.border = '8px solid #e1e1e1';
          div.style.borderRadius = '50%';
          div.style.borderTop = '8px solid #F36E21';
          div.animate([{ transform: 'rotate(0deg)' }, { transform: 'rotate(360deg)' }], {
            duration: 2000,
            iterations: Infinity,
          });
          divContainer.appendChild(div);
          this.__loader = divContainer;

          var progressText = document.createElement('div');
          progressText.style.position = 'absolute';
          progressText.style.left = '48%';
          progressText.style.top = '47%';
          progressText.style.transform = 'translate(-50%, -50%)';
          progressText.style.fontSize = '14px';
          progressText.style.fontWeight = 'bold';
          progressText.style.color = '#333';
          progressText.style.textAlign = 'center';
          divContainer.appendChild(progressText);
          this.__progressText = progressText;

          document.body.appendChild(this.__loader);
        }
        this.__loader.style.display = '';

        var loadTime = 20000; // Adjust the load time duration in milliseconds
        var increment = 20; // Increment in percentage for each interval

        var currentProgress = 0;
        var interval = setInterval(() => {
          currentProgress += increment;
          if (currentProgress > 100) {
            clearInterval(interval);
            this.hide();
          } else {
            this.updateProgress(currentProgress);
          }
        }, loadTime / (100 / increment));
      },
      hide: function () {
        if (this.__loader != null) {
          this.__loader.style.display = 'none';
        }
      },
      updateProgress: function (percentage) {
        if (this.__progressText) {
          this.__progressText.textContent = `${percentage}%`;
        }
      },
    };


</script>
{% endblock content %}
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.1/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-/bQdsTh/da6pkI1MST/rWKFNjaCP5gBSY4sEBT38Q/9RBh9AH40zEOg7Hlq2THRZ"
        crossorigin="anonymous"></script>

</body>
</html>