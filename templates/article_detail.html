{% extends "article/base_steps.html" %} {% load static %} {% load is_string_tags
%} {% block style %} {{ block.super }}
    <link
            rel="stylesheet"
            type="text/css"
            href="{% static 'step2/css/article_detail.css' %}"
    />
{% endblock %} {% block script %} {{ block.super }}

    <script src="{% static 'step2/js/article_detail.js' %}"></script>
{% endblock %} {% block content %}

    <div class="m-4 cover">
        <a
                href="javascript:history.back()"
                class="back-button"
                style="
      background-color: #1434a4;
      color: white;
      width: 35px;
      height: 35px;
      display: flex;
      justify-content: center;
      align-items: center;
      border-radius: 50%;
      text-decoration: none;
    "
        >
            <i class="fa fa-arrow-left"></i>
        </a>
        <!--    <div class="dropdown-right text-end">
                  <button class="btn rounded-circle p-2" type="button" data-bs-toggle="dropdown" aria-expanded="false">
                      <svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" fill="currentColor"
                           class="bi bi-three-dots-vertical" viewBox="0 0 16 16">
                          <path d="M9.5 13a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0zm0-5a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0zm0-5a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0z"/>
                      </svg>
                  </button>
                  <ul class="dropdown-menu">
                      <li>
                          <button class="dropdown-item" id="edit-post">Edit Post</button>
                      </li>
                      <li>
                          <button class="dropdown-item" id="save-post">Save Post</button>
                      </li>
                      <li>
                          <button class="dropdown-item" id="delete-post">Delete Post</button>
                      </li>
                      <li>
                          <button class="dropdown-item" id="copy-post">Copy Post</button>
                      </li>
                  </ul>
              </div> -->
        <form action="{% url 'generate_article:save-post' %}" method="post">
            {% csrf_token %}

            <div
                    id="post-title"
                    style="
        margin-top: 30px;
        color: #1434a4;
        font-size: 20px;
        font-weight: 600;
      "
            >
                {{ post.title }}
            </div>
            <input id="title" type="hidden" name="title" value="{{ post.title }}"/>
            <hr/>

            <div id="post-paragraphs">
                {% for p in post.paragraph %}
                    <div class="post-paragraph" id="postPara">{{ p }}</div>
                    <input type="hidden" name="text" value="{{ p }}" id="para"/>
                {% endfor %}
                <div class="words_wrapper">
                    <div><span class="paragraph-count1"></span></div>
                    <div><span class="paragraph-count2"></span></div>
                    <div><span class="paragraph-count"></span></div>
                </div>
            </div>
            <div
                    class="content-information"
                    style="display: flex; justify-content: center"
            >
                <ul
                        class="content-container"
                        style="
          width: 60%;
          display: flex;
          list-style-type: none;
          justify-content: space-around;
        "
                >
                    <li id="word-count">words</li>
                    <li id="charac-count">character</li>
                    <li id="hashtag-count">hashtag</li>
                </ul>
            </div>
        </form>
        <div style="margin-top: 12px; display: flex; width: 100%">
            <button
                    style="
        border: 0;
        width: 200px;
        padding: 1rem;
        margin-left: auto;
        background: gold;
        border-radius: 8px;
      "
            >
                <a href="http://127.0.0.1:8000/article_list/articles/">Ok</a>
            </button>
        </div>
    </div>

    <!-- <script src="{% static 'step2/js/article_detail.js' %}"></script> -->
    <script>
        document.addEventListener("DOMContentLoaded", () => {
            updCharacWrdCnt();
        });

        // Word count, Character count, Hashtag count
        let wordCount = 0;
        let characCount = 0;
        let hashTagCount = 0;
        console.log(wordCount);

        const updCharacWrdCnt = () => {
            let paragraphContent;
            let paragraphCharacCount;
            let paragraphWordArray;
            let paragraphWordCount;
            let hashTagMatches;
            hashTagCount = 0;

            let titleContent = document.getElementById("post-title").textContent;

            let titleCharacCount = titleContent.length;
            characCount = titleCharacCount;

            let titleWordArray = titleContent.split(" ").filter((word) => word !== "");
            let titleWordCount = titleWordArray.length;
            wordCount = titleWordCount;

            Array(...document.querySelectorAll(".post-paragraph")).map((element) => {
                paragraphContent = element.textContent;

                paragraphCharacCount = paragraphContent.length;
                characCount += paragraphCharacCount;

                paragraphWordArray = paragraphContent
                    .split(" ")
                    .filter((word) => word !== "");
                paragraphWordCount = paragraphWordArray.length;
                wordCount += paragraphWordCount;

                hashTagMatches = paragraphContent.match(/#/g);
                hashTagCount += hashTagMatches ? hashTagMatches.length : 0;
            });

            document.getElementById("word-count").textContent = `${wordCount} word(s)`;
            document.getElementById(
                "charac-count"
            ).textContent = `${characCount} character(s)`;
            document.getElementById(
                "hashtag-count"
            ).textContent = `${hashTagCount} hashtag(s)`;
        };
    </script>
{% endblock %}
